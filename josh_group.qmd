---
title: "josh_group"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(here)
library(janitor)
```

```{r}
group_file_path = "/courses/EDS214/group_project/2024/hurricoders/raw_data/"
```

```{r}
q1_sight <- read_csv(file.path(group_file_path, "QuebradaCuenca1-Bisley.csv"))

q2_site <- read_csv(file.path(group_file_path, "QuebradaCuenca2-Bisley.csv"))

q3_site <- read_csv(file.path(group_file_path, "QuebradaCuenca3-Bisley.csv"))

prm_site <- read_csv(file.path(group_file_path, "RioMameyesPuenteRoto.csv"))

```

Filter data for NO3 and K in areas BQ1, BQ2, BQ3, PRM

```{r}
full_data_set <- q1_sight %>%
  full_join(q2_site) %>%
  full_join(q3_site) %>%
  full_join(prm_site)
  
```

Remove NA and rename new function

```{r}
chem_sights <- full_data_set %>% 
  select('NO3-N', 'K', Sample_ID, Sample_Date) %>%
  filter(between(Sample_Date, as.Date('1990-06-01'), as.Date('1992-12-01'))) %>%
  clean_names() 
  
```

```{r}
ggplot(chem_sights, aes(x = sample_date, y = no3_n)) + 
  geom_rect(aes(xmin = as.Date("1991-10-28"),
                xmax = as.Date("1991-11-02"), 
                ymin = 0,
                ymax = 500),
            fill = "steelblue") +
  geom_rect(aes(xmin = as.Date("1992-08-16"),
                xmax = as.Date("1992-08-29"), 
                ymin = 0,
                ymax = 500),
            fill = "steelblue") +
  geom_rect(aes(xmin = as.Date("1991-08-16"),
                xmax = as.Date("1991-08-20"), 
                ymin = 0,
                ymax = 500),
             fill = "steelblue") +
  geom_line(aes()) +
  facet_wrap(vars(sample_id), ncol = 1) +
  scale_x_date(breaks = scales::breaks_width("1 years"),
               labels = scales::label_date("'%y")) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank()) +
  labs(x = "",
       y = "Potassium \n(K in mg per L)\n",
       title = "Potassium Concentration in Bisley Streams (1990 ~ 1992)")
  geom_line(aes(color = sample_id)) +
  facet_wrap(vars(sample_id), ncol = 1) 
```

```{r}
ggplot(chem_sights, aes(x = sample_date, y = k)) + 
  geom_rect(aes(xmin = as.Date("1991-10-28"),
                 xmax = as.Date("1991-11-02"), 
                 ymin = 0,
                 ymax = 3.5),
             fill = "steelblue") +
   geom_rect(aes(xmin = as.Date("1992-08-16"),
                 xmax = as.Date("1992-08-29"), 
                 ymin = 0,
                 ymax = 3.5),
             fill = "steelblue") +
  geom_rect(aes(xmin = as.Date("1991-08-16"),
                 xmax = as.Date("1991-08-20"), 
                 ymin = 0,
                 ymax = 3.5),
             fill = "steelblue") +
  geom_line(aes()) +
  facet_wrap(vars(sample_id), ncol = 1) +
  scale_x_date(breaks = scales::breaks_width("1 years"),
               labels = scales::label_date("'%y")) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank()) +
  labs(x = "",
       y = "Potassium \n(K in mg per L)\n",
       title = "Potassium Concentration in Bisley Streams (1990 ~ 1992)")
  
```
